<div class="admin-dashboard container mx-auto p-4">
  <h2 class="text-2xl mb-4">Admin Dashboard</h2>

  @if (!isAdmin) {
    <div class="alert alert-warning">
      <p>You are not authorized to view admin tools.</p>
      <button class="btn btn-secondary" (click)="goHome()">Back</button>
    </div>
  }

  @if (isAdmin) {
    <div>
      <p class="mb-2">
        Use the button below to run the server migration that ensures
        personal folders exist for each existing user.
      </p>
      <p class="mb-4">
        <strong>Note:</strong> This action may create folders for many users
        and should be run by an administrator.
      </p>
      <button
        class="btn btn-primary"
        (click)="runMigration()"
        [disabled]="running">
        @if (!running) {
          <span>Run Personal Folder Migration</span>
        }
        @if (running) {
          <span>Running migration...</span>
        }
      </button>
      <hr class="my-4" />
      <div class="mt-4">
        <p class="mb-2">Create personal folder for a specific user</p>
        <div class="flex gap-2 items-center mb-2">
          <input
            id="userIdInput"
            class="form-input"
            [(ngModel)]="userIdToCreate"
            placeholder="Enter user ID (GUID)" />
            <button
              id="createPersonalFolderBtn"
              class="btn btn-secondary"
              (click)="createPersonalFolderForUser()"
              [disabled]="creatingUser || !userIdToCreate">
              @if (!creatingUser) {
                <span>Create Personal Folder</span>
              }
              @if (creatingUser) {
                <span>Creating...</span>
              }
            </button>
          </div>
          @if (createUserResultMessage) {
            <div>
              <p><strong>Result:</strong> {{ createUserResultMessage }}</p>
              @if (createUserCreated !== null) {
                <p>
                  Created: {{ createUserCreated }}
                </p>
              }
            </div>
          }
        </div>
        @if (resultMessage) {
          <div class="mt-4">
            <p><strong>Result:</strong> {{ resultMessage }}</p>
            @if (createdCount !== null) {
              <p>Created: {{ createdCount }}</p>
            }
          </div>
        }
      </div>
    }
  </div>
